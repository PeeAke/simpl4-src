defaultTasks "buildAll"

task stage (type:Task) {
	ant.concat(destfile:"${surfaceBuild}/${jsLibs}") {
		fileset(file:'libs/modernizr.js')
		fileset(file:'libs/detectizr.js')
		fileset(file:'libs/debug-ie-dummy.js')
		fileset(file:'libs/require-dummy.js')
		fileset(file:'libs/xregexp-all.js')
		fileset(file:'libs/startswith.js')
		fileset(file:'libs/classlist.js')
		fileset(file:'libs/date-now.js')
		fileset(file:'libs/request-animationframe.js')
		fileset(file:'libs/matchmedia.js')
		fileset(file:'libs/underscore.js')
		fileset(file:'libs/jquery-2.1.1.js')
		fileset(file:'libs/jquery.tap.js')
		fileset(file:'libs/Args.js')
		fileset(file:'libs/cache.js')
		fileset(file:'libs/es6-promise-2.0.1.js')
		fileset(file:'libs/regula-1.3.4.js')
		fileset(file:'libs/moment.js')
		fileset(file:'libs/pikaday-time.js')
		fileset(file:'libs/bootstrap-datetimepicker.js')
		fileset(file:'libs/jQuery.extendext.js')
		fileset(file:'libs/microevent.js')
		fileset(file:'libs/postal.js')
		fileset(file:'libs/mensch.js')
		fileset(file:'libs/json5.js')
		fileset(file:'libs/wampy.js')
//		fileset(file:'libs/interact.js')
		fileset(file:'libs/openseadragon-all.js')
		fileset(file:'libs/reconnecting-websocket.js')
		fileset(file:'libs/rx.all.compat.js')
		fileset(file:'libs/rx.dom.compat.js')
		fileset(file:'libs/shortid.js')
		fileset(file:'libs/multimap.js')
		fileset(file:'libs/accounting.js')
//		fileset(file:'libs/mutation-summary.js')
		fileset(file:'src/util/Construct.js')
		fileset(file:'libs/svg.js')
		fileset(file:'libs/panzoom.js')
		fileset(file:'libs/jsonpath.js')
		fileset(file:'libs/selectize.js')
		fileset(file:'libs/jquery.pep.js')
		fileset(file:'libs/jquery.scrollTo.js')
		fileset(file:'libs/sugar.dev.js')
		fileset(file:'libs/esprima.js')
		fileset(file:'libs/metaes.js')
		fileset(file:'libs/Font.js')
		fileset(file:'libs/jquery.touchSwipe.js')
		fileset(dir:'src',includes:'**/*.js', excludes:'src/util/Construct.js')
	}
	def strip = "bin/jsstrip.sh  -o " + surfaceBuild + "/" + jsLibs 
		exec {
			commandLine strip.tokenize()
		}
	ant.gzip( src:"${surfaceBuild}/${jsLibs}",destfile:"${surfaceBuild}/${jsLibs}.gz")
	ant.gzip( src:"libs/webcomponents-lite.js",destfile:"${surfaceBuild}/webcomponents-lite.js.gz")
	ant.delete( file:"${surfaceBuild}/${jsLibs}")
}

task buildAll (type:Task) {  dependsOn stage }
