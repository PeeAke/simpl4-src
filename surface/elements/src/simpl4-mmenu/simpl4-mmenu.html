<link rel="import" href="mmenu-import.html">

<polymer-element name="simpl4-mmenu" attributes="searchfield slidingSubmenus pages selected selectedModel onCoreSelect onClickHandler" flex relative>
<template>
  <link rel="stylesheet" type="text/css" href="simpl4-mmenu.css" />
  <nav id="mainmenu">
    <ul>
      <template repeat="{{node in nodes }}" id="t">
        <template if="{{ node.children==null || node.children.length==0 }}">
          <li>
            <a href="{{ node.url }}"><font-awesome icon="home"></font-awesome>{{node.name}}</a>
          </li>
        </template>
        <template if="{{ node.children && node.children.length>0 }}">
          <li>
            <a href="{{ node.url }}">{{node.name}}</a>
            <ul>
              <template ref="t" repeat="{{node in node.children}}"></template>
            </ul>
          </li>
        </template>
      </template>
    </ul>
  </nav>
  <content></content>
</template>
  <script>
			Polymer('simpl4-mmenu', {
				ready: function () {
					console.log("Ready:"+this.slidingSubmenus+"/"+this.searchfield);

					$(this.$.mainmenu).mmenu({
						classes: "mm-light mm-zoom-panels",
						slidingSubmenus: this.slidingSubmenus == "true",
						searchfield: this.searchfield != "false",
						body: $(this.$.mainmenu),
						offCanvas: false

					});
					console.log("Ready4");
				},
				created: function () {
					console.log("created");
					this.nodes = [{
						"name": "Croatia",
						"hash": "0"
					},
					{
						"name": "England",
						"hash": "1",
						"url": "#england",
						"children": [{
							"name": "Arsenal",
							"url": "test.adoc",
							"hash": "0-0"
						},
						{
							"name": "Manchester United",
							"hash": "0-2"
						}]
					},
					{
						"name": "Spain",
						"hash": "2",
						"children": [{
							"name": "Barcelona",
							"hash": "2-0"
						},
						{
							"name": "Real Madrid",
							"hash": "2-1"
						}]
					},
					{
						"name": "Germany",
						"hash": "3",
						"children": [{
							"name": "Bayern Munich",
							"hash": "3-1"
						},
						{
							"name": "Borrusia Dortmund",
							"hash": "3-2"
						}]
					}];
					this.pages = [];
					this._traverse(this.nodes);
				},
				_traverse: function (nodes) {
					for (var i = 0; i < nodes.length; i++) {
						var node = nodes[i];
						if (node.children && node.children.length > 0) {
							this.pages.push(node);
							this._traverse(node.children);
						} else {
							var page = {
								name: node.name,
								url: node.url,
								hash: node.hash
							}
							this.pages.push(node);
						}
					}
				}
			});
  </script>
</polymer-element>
