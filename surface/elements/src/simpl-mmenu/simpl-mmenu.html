<!--
/**
 * This file is part of SIMPL4(http://simpl4.org).
 *
 * 	Copyright [2014] [Manfred Sattler] <manfred@ms123.org>
 *
 * SIMPL4 is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * SIMPL4 is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with SIMPL4.  If not, see <http://www.gnu.org/licenses/>.
 */
-->
<link rel="import" href="import-js.html">
<polymer-element name="simpl-mmenu" attributes="searchfield slidingSubmenus pages" flex relative>
	<template>
		<link rel="stylesheet" type="text/css" href="simpl-mmenu.css" />
		<nav class="nav" id="mainmenu">
			<ul>
				<template repeat="{{node in nodes  }}" id="t">
					<template if="{{ node.children==null || node.children.length==0 }}">
						<li class="{{ level==-1 ? 'firstLevel' : ''}}" id="X{{node.hash}}">
							<a onclick="return false" href="{{node.url}}">
								<font-awesome icon="{{node.icon}}"></font-awesome>{{node.name|tr}}</a>
						</li>
					</template>
					<template if="{{ node.children && node.children.length>0 }}">
						<li class="{{ level==-1 ? 'firstLevel' : ''}}" id="X{{node.hash}}">
							<a onclick="return false" href="#">
								<font-awesome icon="{{node.icon}}"></font-awesome>{{node.name|tr}}</a>
							<ul>
								<template ref="t" repeat="{{node,level in node.children}}"></template>
							</ul>
						</li>
					</template>
				</template>
			</ul>
		</nav>
		<content></content>
	</template>
	<script>
		Polymer('simpl-mmenu', {
			level: -1,
			ready: function() {
				console.log("MMenu.Ready");
				$(this.$.mainmenu).mmenu({
					classes: "mm-white mm-zoom-panels",
					slidingSubmenus: this.slidingSubmenus == "true",
					searchfield: this.searchfield != "false",
					body: $(this.$.mainmenu),
					offCanvas: false

				});
			},
			created: function() {
				console.log("created");
				this.nodes = [{
					"name": "Croatia",
					"icon": "fax",
					"url": "filter.html",
					"hash": "0"
				}, {
					"name": "England",
					"hash": "1",
					"icon": "home",
					"url": "firstform.html",
					"children": [{
						"name": "Arsenal",
						"url": "test.adoc",
						"icon": "gift",
						"hash": "0-0"
					}, {
						"name": "Manchester United",
						"url": "test2.adoc",
						"icon": "key",
						"hash": "0-2"
					}]
				}, {
					"name": "Spain",
					"hash": "2",
					"url": "stackedForm.html",
					"url": "demo1.html",
					"icon": "inbox",
					"children": [{
						"name": "Barcelona",
						"icon": "plug",
						"hash": "2-0"
					}, {
						"name": "Real Madrid",
						"icon": "mobile",
						"hash": "2-1"
					}]
				}, {
					"name": "Germany",
					"hash": "3",
					"icon": "globe",
					"url": "demo2.html",
					"children": [{
						"name": "Bayern Munich",
						"icon": "plus",
						"hash": "3-1"
					}, {
						"name": "Borrusia Dortmund",
						"icon": "minus",
						"hash": "3-2"
					}]
				}];
				this.pages = [];
				this._traverse(this.nodes);
			},
			_traverse: function(nodes) {
				for (var i = 0; i < nodes.length; i++) {
					var node = nodes[i];
					//					node.hash = node.url;
					if (node.children && node.children.length > 0) {
						this.pages.push(node);
						this._traverse(node.children);
					} else {
						this.pages.push(node);
					}
				}
			}
		});
	</script>
</polymer-element>
